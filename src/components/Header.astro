---
import BookmarkIcon from "../icons/Bookmark.astro";
import SearchIcon from "../icons/Search.astro";
import MenuIcon from "../icons/Menu.astro";
import XIcon from "../icons/X.astro";

// í˜„ì¬ í˜ì´ì§€ ê°ì§€
const currentPath = Astro.url.pathname;
const isHomePage = currentPath === "/" || currentPath.startsWith("/gags/");
const isTagsPage = currentPath === "/tags" || currentPath.startsWith("/tags/");
const isPopularPage = currentPath === "/popular";
const isLatestPage = currentPath === "/latest";
const isRandomPage = currentPath === "/random";
const isSearchPage = currentPath === "/search";
const isSavedPage = currentPath === "/saved";

// í™œì„± ìƒíƒœ ìŠ¤íƒ€ì¼
const getNavStyle = (isActive: boolean) => {
  return isActive
    ? "text-primary font-semibold transition-colors"
    : "text-foreground hover:text-primary transition-colors";
};

const getSavedStyle = (isActive: boolean) => {
  return isActive
    ? "inline-flex items-center px-3 py-2 bg-primary/10 text-primary font-semibold rounded-md transition-colors"
    : "inline-flex items-center px-3 py-2 hover:bg-accent rounded-md transition-colors";
};

// ëª¨ë°”ì¼ ë„¤ë¹„ê²Œì´ì…˜ìš© ìŠ¤íƒ€ì¼
const getMobileNavStyle = (isActive: boolean) => {
  return isActive
    ? "text-primary font-semibold bg-primary/10 px-3 py-2 rounded-md transition-colors"
    : "text-foreground hover:text-primary px-3 py-2 rounded-md hover:bg-accent transition-colors";
};
---

<header
  class="sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b border-border"
>
  <div class="container mx-auto px-4 py-4">
    <div class="flex items-center justify-between">
      <a href="/" class="flex items-center space-x-2">
        <div class="text-2xl font-bold text-primary">ğŸ¤£</div>
        <div>
          <h1 class="text-xl font-bold text-foreground">ì•„ì¬ë‹¬ë ˆ</h1>
          <p class="text-xs text-muted-foreground hidden sm:block">
            ì•„ì¬ê°œê·¸ë¡œ ì›ƒì–´ë‹¬ë ˆ
          </p>
        </div>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden md:flex items-center space-x-8">
        <a href="/" class={getNavStyle(isHomePage)}> ğŸ  í™ˆ </a>
        <a href="/latest" class={getNavStyle(isLatestPage)}> ğŸŒŸ ìµœì‹ ê°œê·¸ </a>
        <a href="/popular" class={getNavStyle(isPopularPage)}> ğŸ”¥ ì¸ê¸°ê°œê·¸ </a>
        <a href="/random" class={getNavStyle(isRandomPage)}> ğŸ² ëœë¤ê°œê·¸ </a>
        <a href="/tags" class={getNavStyle(isTagsPage)}> ğŸ·ï¸ íƒœê·¸ </a>
      </nav>

      <div class="hidden md:flex items-center space-x-4">
        <a href="/saved" class={getSavedStyle(isSavedPage)}>
          <BookmarkIcon size={16} class="mr-2" />
          ì €ì¥ëª©ë¡
        </a>
        <a
          href="/search"
          class="p-2 hover:bg-accent rounded-md transition-colors"
        >
          <SearchIcon size={16} />
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-btn"
        class="md:hidden p-2 hover:bg-accent rounded-md transition-colors"
        aria-label="ë©”ë‰´"
      >
        <MenuIcon id="menu-icon" size={20} />
        <XIcon id="close-icon" size={20} class="hidden" />
      </button>
    </div>

    <!-- Mobile Navigation -->
    <nav
      id="mobile-menu"
      class="hidden md:hidden mt-4 pb-4 border-t border-border pt-4"
    >
      <div class="flex flex-col space-y-2">
        <a href="/" class={getMobileNavStyle(isHomePage)}> ğŸ  í™ˆ </a>
        <a href="/latest" class={getMobileNavStyle(isLatestPage)}>
          ğŸŒŸ ìµœì‹ ê°œê·¸
        </a>
        <a href="/popular" class={getMobileNavStyle(isPopularPage)}>
          ğŸ”¥ ì¸ê¸°ê°œê·¸
        </a>
        <a href="/random" class={getMobileNavStyle(isRandomPage)}>
          ğŸ² ëœë¤ê°œê·¸
        </a>
        <a href="/tags" class={getMobileNavStyle(isTagsPage)}> ğŸ·ï¸ íƒœê·¸ </a>
        <a href="/saved" class={getMobileNavStyle(isSavedPage)}>
          ğŸ’¾ ì €ì¥ëª©ë¡
        </a>
        <a href="/search" class={getMobileNavStyle(isSearchPage)}> ğŸ” ê²€ìƒ‰ </a>
      </div>
    </nav>
  </div>
</header>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const mobileMenuBtn = document.getElementById("mobile-menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");
    const menuIcon = document.getElementById("menu-icon");
    const closeIcon = document.getElementById("close-icon");

    if (mobileMenuBtn && mobileMenu && menuIcon && closeIcon) {
      mobileMenuBtn.addEventListener("click", () => {
        // Toggle menu visibility
        mobileMenu.classList.toggle("hidden");

        // Toggle icons
        menuIcon.classList.toggle("hidden");
        closeIcon.classList.toggle("hidden");
      });

      // Close menu when clicking a link
      mobileMenu.querySelectorAll("a").forEach((link) => {
        link.addEventListener("click", () => {
          mobileMenu.classList.add("hidden");
          menuIcon.classList.remove("hidden");
          closeIcon.classList.add("hidden");
        });
      });
    }
  });
</script>
