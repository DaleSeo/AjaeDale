---
import Layout from "../../layouts/Layout.astro";
import { getStaticPathsLocales, normalizeLang } from "../../utils/i18n";

export async function getStaticPaths() {
  return getStaticPathsLocales().map((lang) => ({
    params: { lang },
  }));
}

const { lang: langParam } = Astro.params;
const lang = normalizeLang(langParam);

// í˜ì´ì§€ë³„ ë©”ì‹œì§€ ì •ì˜
const messages = {
  ko: {
    title: "ê°œê·¸ API",
    description: "ì•„ì¬ë‹¬ë ˆ ê°œê·¸ ë°ì´í„°ë¥¼ ììœ ë¡­ê²Œ ì‚¬ìš©í•˜ì„¸ìš”",
    overview: {
      title: "ê°œìš”",
      description:
        "ì•„ì¬ë‹¬ë ˆëŠ” ë¬´ë£Œ REST APIë¥¼ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ëŠ” ì½ê¸° ì „ìš©ì´ë©°, ë¹Œë“œ ì‹œì ì— ì •ì  JSON íŒŒì¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.",
      feature1: "âœ… ì™„ì „ ë¬´ë£Œ - ì¸ì¦ ë¶ˆí•„ìš”",
      feature2: "âœ… CORS ì§€ì› - ëª¨ë“  ë„ë©”ì¸ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥",
      feature3: "âœ… ì •ì  íŒŒì¼ - ë¹ ë¥¸ ì‘ë‹µ ì†ë„",
      feature4: "âœ… ì½ê¸° ì „ìš© - GET ìš”ì²­ë§Œ ì§€ì›",
    },
    endpoints: {
      gags: {
        title: "ê°œê·¸ ì—”ë“œí¬ì¸íŠ¸",
        all: {
          title: "ëª¨ë“  ê°œê·¸ ì¡°íšŒ",
          description: "ê²Œì‹œëœ ëª¨ë“  ê°œê·¸ë¥¼ ìµœì‹ ìˆœìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.",
        },
        single: {
          title: "íŠ¹ì • ê°œê·¸ ì¡°íšŒ",
          description: "slugë¡œ íŠ¹ì • ê°œê·¸ì˜ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.",
        },
        featured: {
          title: "ì¸ê¸° ê°œê·¸ ì¡°íšŒ",
          description: "featuredë¡œ í‘œì‹œëœ ì¸ê¸° ê°œê·¸ë§Œ ë°˜í™˜í•©ë‹ˆë‹¤.",
        },
        latest: {
          title: "ìµœì‹  ê°œê·¸ ì¡°íšŒ",
          description: "ìµœì‹  20ê°œì˜ ê°œê·¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.",
        },
      },
      tags: {
        title: "íƒœê·¸ ì—”ë“œí¬ì¸íŠ¸",
        all: {
          title: "ëª¨ë“  íƒœê·¸ ì¡°íšŒ",
          description: "ëª¨ë“  íƒœê·¸ì™€ ê° íƒœê·¸ì˜ ê°œê·¸ ìˆ˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.",
        },
        single: {
          title: "íƒœê·¸ë³„ ê°œê·¸ ì¡°íšŒ",
          description: "íŠ¹ì • íƒœê·¸ê°€ í¬í•¨ëœ ëª¨ë“  ê°œê·¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.",
        },
      },
    },
    cors: {
      title: "CORS",
      description:
        "ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ëŠ” CORSê°€ í™œì„±í™”ë˜ì–´ ìˆì–´ ì–´ë–¤ ë„ë©”ì¸ì—ì„œë“  ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    },
    usage: {
      title: "ì‚¬ìš© ì˜ˆì‹œ",
      description: "JavaScriptì—ì„œ fetch APIë¡œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:",
    },
    example: "ì˜ˆì‹œ ì‘ë‹µ ë³´ê¸°",
  },
  en: {
    title: "Pun API",
    description: "Use AjaeDale pun data freely",
    overview: {
      title: "Overview",
      description:
        "AjaeDale provides a free REST API. All endpoints are read-only and generated as static JSON files at build time.",
      feature1: "âœ… Completely Free - No authentication required",
      feature2: "âœ… CORS Enabled - Accessible from any domain",
      feature3: "âœ… Static Files - Fast response times",
      feature4: "âœ… Read-only - GET requests only",
    },
    endpoints: {
      gags: {
        title: "Pun Endpoints",
        all: {
          title: "Get All Puns",
          description: "Returns all published puns sorted by creation date.",
        },
        single: {
          title: "Get Single Pun",
          description: "Get detailed information for a specific pun by slug.",
        },
        featured: {
          title: "Get Featured Puns",
          description: "Returns only puns marked as featured.",
        },
        latest: {
          title: "Get Latest Puns",
          description: "Returns the 20 most recent puns.",
        },
      },
      tags: {
        title: "Tag Endpoints",
        all: {
          title: "Get All Tags",
          description: "Returns all tags with pun counts for each tag.",
        },
        single: {
          title: "Get Puns by Tag",
          description: "Returns all puns containing a specific tag.",
        },
      },
    },
    cors: {
      title: "CORS",
      description:
        "All API endpoints have CORS enabled and can be accessed from any domain.",
    },
    usage: {
      title: "Usage Example",
      description: "Easy to use with the fetch API in JavaScript:",
    },
    example: "View Example Response",
  },
};

const t = messages[lang as keyof typeof messages] || messages.ko;

const title = t.title;
const description = t.description;
const baseUrl = "https://www.ajaedale.com";
---

<Layout title={title} description={description} currentPage="api">
  <section class="px-4 py-16">
    <div class="container mx-auto max-w-4xl">
      <!-- í˜ì´ì§€ í—¤ë” -->
      <div class="mb-12 text-center">
        <h1 class="text-foreground mb-4 text-3xl font-bold">ğŸš€ {title}</h1>
        <p class="text-muted-foreground text-lg">
          {description}
        </p>
      </div>

      <!-- API ê°œìš” -->
      <div class="bg-muted/50 mb-8 rounded-lg p-6">
        <h2 class="text-foreground mb-4 text-2xl font-semibold">
          {t.overview.title}
        </h2>
        <p class="text-muted-foreground mb-4">
          {t.overview.description}
        </p>
        <ul class="text-muted-foreground list-inside list-disc space-y-2">
          <li>{t.overview.feature1}</li>
          <li>{t.overview.feature2}</li>
          <li>{t.overview.feature3}</li>
          <li>{t.overview.feature4}</li>
        </ul>
      </div>

      <!-- ê°œê·¸ ì—”ë“œí¬ì¸íŠ¸ -->
      <div class="mb-8">
        <h2 class="text-foreground mb-6 text-2xl font-semibold">
          {t.endpoints.gags.title}
        </h2>

        <!-- ëª¨ë“  ê°œê·¸ -->
        <div class="bg-card mb-6 rounded-lg border p-6">
          <div class="mb-4">
            <h3 class="text-foreground mb-2 text-xl font-medium">
              {t.endpoints.gags.all.title}
            </h3>
            <code
              class="bg-muted text-primary block rounded px-3 py-2 font-mono text-sm"
            >
              GET {baseUrl}/api/gags.json
            </code>
          </div>
          <p class="text-muted-foreground mb-4">
            {t.endpoints.gags.all.description}
          </p>
          <details class="mb-4">
            <summary
              class="text-primary cursor-pointer font-medium hover:underline"
            >
              {t.example}
            </summary>
            <pre
              class="bg-muted mt-4 overflow-x-auto rounded p-4"><code class="text-sm">{JSON.stringify(
                [
                  {
                    slug: "king-falls-kingkong",
                    lang: "ko",
                    title: "ì™•ì´ ë„˜ì–´ì§€ë©´?",
                    description: "í‚¹ì½©",
                    tags: ["ì™•"],
                    featured: false,
                    createdAt: "2025-09-23T00:17:31.623Z",
                  },
                ],
                null,
                2,
              )}</code></pre>
          </details>
        </div>

        <!-- ê°œë³„ ê°œê·¸ -->
        <div class="bg-card mb-6 rounded-lg border p-6">
          <div class="mb-4">
            <h3 class="text-foreground mb-2 text-xl font-medium">
              {t.endpoints.gags.single.title}
            </h3>
            <code
              class="bg-muted text-primary block rounded px-3 py-2 font-mono text-sm"
            >
              GET {baseUrl}/api/gags/[slug].json
            </code>
          </div>
          <p class="text-muted-foreground mb-4">
            {t.endpoints.gags.single.description}
          </p>
        </div>

        <!-- ì¸ê¸° ê°œê·¸ -->
        <div class="bg-card mb-6 rounded-lg border p-6">
          <div class="mb-4">
            <h3 class="text-foreground mb-2 text-xl font-medium">
              {t.endpoints.gags.featured.title}
            </h3>
            <code
              class="bg-muted text-primary block rounded px-3 py-2 font-mono text-sm"
            >
              GET {baseUrl}/api/gags/featured.json
            </code>
          </div>
          <p class="text-muted-foreground">
            {t.endpoints.gags.featured.description}
          </p>
        </div>

        <!-- ìµœì‹  ê°œê·¸ -->
        <div class="bg-card mb-6 rounded-lg border p-6">
          <div class="mb-4">
            <h3 class="text-foreground mb-2 text-xl font-medium">
              {t.endpoints.gags.latest.title}
            </h3>
            <code
              class="bg-muted text-primary block rounded px-3 py-2 font-mono text-sm"
            >
              GET {baseUrl}/api/gags/latest.json
            </code>
          </div>
          <p class="text-muted-foreground">
            {t.endpoints.gags.latest.description}
          </p>
        </div>
      </div>

      <!-- íƒœê·¸ ì—”ë“œí¬ì¸íŠ¸ -->
      <div class="mb-8">
        <h2 class="text-foreground mb-6 text-2xl font-semibold">
          {t.endpoints.tags.title}
        </h2>

        <!-- ëª¨ë“  íƒœê·¸ -->
        <div class="bg-card mb-6 rounded-lg border p-6">
          <div class="mb-4">
            <h3 class="text-foreground mb-2 text-xl font-medium">
              {t.endpoints.tags.all.title}
            </h3>
            <code
              class="bg-muted text-primary block rounded px-3 py-2 font-mono text-sm"
            >
              GET {baseUrl}/api/tags.json
            </code>
          </div>
          <p class="text-muted-foreground mb-4">
            {t.endpoints.tags.all.description}
          </p>
          <details class="mb-4">
            <summary
              class="text-primary cursor-pointer font-medium hover:underline"
            >
              {t.example}
            </summary>
            <pre
              class="bg-muted mt-4 overflow-x-auto rounded p-4"><code class="text-sm">{JSON.stringify(
                [
                  {
                    name: "ì™•",
                    slug: "wang",
                    count: 5,
                  },
                ],
                null,
                2,
              )}</code></pre>
          </details>
        </div>

        <!-- íƒœê·¸ë³„ ê°œê·¸ -->
        <div class="bg-card mb-6 rounded-lg border p-6">
          <div class="mb-4">
            <h3 class="text-foreground mb-2 text-xl font-medium">
              {t.endpoints.tags.single.title}
            </h3>
            <code
              class="bg-muted text-primary block rounded px-3 py-2 font-mono text-sm"
            >
              GET {baseUrl}/api/tags/[slug].json
            </code>
          </div>
          <p class="text-muted-foreground">
            {t.endpoints.tags.single.description}
          </p>
        </div>
      </div>

      <!-- CORS -->
      <div class="bg-muted/50 mb-8 rounded-lg p-6">
        <h2 class="text-foreground mb-4 text-2xl font-semibold">
          {t.cors.title}
        </h2>
        <p class="text-muted-foreground">
          {t.cors.description}
        </p>
      </div>

      <!-- ì‚¬ìš© ì˜ˆì‹œ -->
      <div class="bg-card rounded-lg border p-6">
        <h2 class="text-foreground mb-4 text-2xl font-semibold">
          {t.usage.title}
        </h2>
        <p class="text-muted-foreground mb-4">
          {t.usage.description}
        </p>
        <pre
          class="bg-muted overflow-x-auto rounded p-4"><code class="text-sm">fetch('{baseUrl}/api/gags.json')
  .then(response => response.json())
  .then(data => console.log(data));</code></pre>
      </div>
    </div>
  </section>
</Layout>
